#Download Lexicon in Python Dictionary called
import urllib.request, json
with urllib.request.urlopen("https://storage.googleapis.com/wd13/lexicon.txt") as url:
  lexicon_file = url.read().decode()
lexicon = {}
for line in lexicon_file.split('\n'):
  split_line = line.split('\t')
  token = split_line[0]
  score = float(split_line[1])
  lexicon[token] = score

def sentiment_scoring(text,lexicon): #to get the score out of the dictionary so you add them in the input

  if text is None:
    return 0 #if for example you want to find a review but there's no text you put 0

  words = text.lower().split() #tokenize can immediately lower case

  score = 0 #define initiate the score of zero
  for word in words: #I want to get the score of the word in the list for example the list is I, am, in, class, I want to get the score of I in this function
    if word in lexicon:
      score += lexicon[word] #get the score of particular word, we dont know that word yet
    else:
      score+=0

  return score

!pip install google-play-scraper

import google_play_scraper #after installing next is importing

appid = 'com.td'

td_reviews = google_play_scraper.reviews_all(
  appid,
  lang='en',
  country='ca')

for td_review in td_reviews:
  content = td_review['content']
  sentiment_score = sentiment_scoring(content,lexicon) #you want to get the score and change text to content of the reviews
  td_review['sentiment_score']=sentiment_score #I want to add this on the reivew

td_reviews[0:2]

lexicon['great'] #so if i get customer service lexicon score it does not exist the function assigned it as 0
lexicon['like']
for td_review in td_reviews: #adding flag or flagging as indicator
  td_review['sentiment_flag'] = 'Positive' if td_review['sentiment_score']>0 else 'Negative'
  td_review['Year'] = td_review['at'].year
  td_review['Month'] = td_review['at'].month #the result you will see that the added Year and Month on td_reviews
import pandas as pd

df = pd.DataFrame(td_reviews) #we will put dataframe from td_reviews to make it look better

df.head(2) #you can see the added function sentiment_score sentiment_flag year and month

df['sentiment_flag']

df['sentiment_flag'] == 'Positive' #for boolean variable

positive_flag_df = df[df['sentiment_flag'] == 'Positive'] #to get the positive reviews

df[df['sentiment_flag'] == 'Positive']
